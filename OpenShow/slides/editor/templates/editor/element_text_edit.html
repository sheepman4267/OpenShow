{% load icon %}
<form id="form-{{ object.pk }}" class="{{ object.css_class }}">
    {% csrf_token %}
    <div id="edit-element-{{ object.pk }}" class="editor-editable" contenteditable="true">{{ object.body|safe }}</div>
    <input type="hidden" id="element-{{ object.pk }}-body" name="body">
    <div class="element-edit-buttons">
        <button
                hx-select="#element-{{ object.pk }}"
                hx-target="#form-{{ object.pk }}"
                hx-swap="outerHTML swap:0.1s"
                hx-post="{% url 'edit-element-text' object.pk %}"
                hx-trigger="hs-submit"
                _="
                def submit_text
                    set #element-{{ object.pk }}-body's @value to #edit-element-{{ object.pk }}'s innerHTML
                    then send 'hs-submit' to me
                end
                on click
                    submit_text()
                end
                on keydown[ctrlKey and key is 'Enter'] from the closest <form/>
                    submit_text()
                end
                on full_submit
                    submit_text()
                end
                "
                type="button"
                class="icon-button element-submit"
                id="submit-element-{{ object.pk }}"
        >
            {% icon 'check' %}
        </button>
    </div>
</form>